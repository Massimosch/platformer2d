[gd_scene load_steps=27 format=3 uid="uid://dhbiv5ngts8cn"]

[ext_resource type="Texture2D" uid="uid://hqcpl117jt" path="res://AutoFootStepsPlugin/Example/Materials/whispy-grass-meadow-unity/wispy-grass-meadow_albedo.png" id="1_kryyk"]
[ext_resource type="Script" path="res://AutoFootStepsPlugin/AutoFootSteps.gd" id="1_o0483"]
[ext_resource type="Texture2D" uid="uid://xobxrxdg7wrk" path="res://AutoFootStepsPlugin/Example/Materials/wavy-sand-unity/wavy-sand_albedo.png" id="2_ojqbs"]
[ext_resource type="Texture2D" uid="uid://clpohbm8bdtw1" path="res://AutoFootStepsPlugin/Example/Materials/streaky-plywood-unity/streaky-plywood_albedo.png" id="3_u3nso"]
[ext_resource type="Texture2D" uid="uid://bl3bdw45sg8rh" path="res://AutoFootStepsPlugin/Example/Materials/gravel/gravel_path-albedo.png" id="4_uikd5"]
[ext_resource type="Texture2D" uid="uid://6a5m0ri7ppwx" path="res://AutoFootStepsPlugin/Example/Materials/mossy-mud1-unity/mossy_mud1_albedo.png" id="6_5ouei"]
[ext_resource type="Texture2D" uid="uid://cbi210cy8vqee" path="res://AutoFootStepsPlugin/Example/Materials/Snow/snow-packed12-ao.png" id="7_12oyg"]
[ext_resource type="Texture2D" uid="uid://85rgr2lra0hk" path="res://AutoFootStepsPlugin/Example/Materials/rocky-asphalt1-unity/rocky_asphalt1_albedo.png" id="8_7kh5p"]
[ext_resource type="Texture2D" uid="uid://bs2b8lpgks0pm" path="res://AutoFootStepsPlugin/Example/Materials/reinforced-metal-unity/reinforced-metal_albedo.png" id="9_x6e60"]
[ext_resource type="Resource" uid="uid://o55dy6ahuokg" path="res://AutoFootStepsPlugin/DefaultSounds/BareFootProfile.tres" id="10_uo7lj"]

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_r0myj"]
sky_top_color = Color(0.384314, 0.454902, 0.54902, 1)
sky_horizon_color = Color(0.647059, 0.654902, 0.670588, 1)
sky_energy_multiplier = 0.0
ground_bottom_color = Color(1, 1, 1, 1)
ground_energy_multiplier = 0.0

[sub_resource type="Sky" id="Sky_a388g"]
sky_material = SubResource("ProceduralSkyMaterial_r0myj")

[sub_resource type="Environment" id="Environment_wpvn0"]
background_mode = 2
sky = SubResource("Sky_a388g")
ambient_light_source = 3

[sub_resource type="BoxMesh" id="BoxMesh_x0era"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_gyww7"]
albedo_texture = ExtResource("1_kryyk")
metallic_specular = 0.0
uv1_scale = Vector3(0.5, 0.5, 0.5)
uv1_triplanar = true
uv1_world_triplanar = true

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_cp2ox"]
albedo_texture = ExtResource("8_7kh5p")
uv1_scale = Vector3(0.5, 0.5, 0.5)
uv1_triplanar = true
uv1_world_triplanar = true

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_71n5t"]
albedo_texture = ExtResource("3_u3nso")
uv1_scale = Vector3(0.5, 0.5, 0.5)
uv1_triplanar = true
uv1_world_triplanar = true

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_puy43"]
albedo_texture = ExtResource("6_5ouei")
roughness = 0.6
uv1_scale = Vector3(0.5, 0.5, 0.5)
uv1_triplanar = true
uv1_world_triplanar = true

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_ir7d1"]
albedo_texture = ExtResource("9_x6e60")
metallic = 1.0
roughness = 0.35
uv1_scale = Vector3(0.5, 0.5, 0.5)
uv1_triplanar = true
uv1_world_triplanar = true

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_d7xvt"]
albedo_texture = ExtResource("7_12oyg")
metallic = 0.16
roughness = 0.35
uv1_scale = Vector3(0.5, 0.5, 0.5)
uv1_triplanar = true
uv1_world_triplanar = true

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_4ir7p"]
albedo_texture = ExtResource("4_uikd5")
uv1_scale = Vector3(0.5, 0.5, 0.5)
uv1_triplanar = true
uv1_world_triplanar = true

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_83cii"]
albedo_texture = ExtResource("2_ojqbs")
roughness = 0.62
uv1_scale = Vector3(0.5, 0.5, 0.5)
uv1_triplanar = true
uv1_world_triplanar = true

[sub_resource type="GDScript" id="GDScript_vmt5a"]
script/source = "extends CharacterBody3D


var SPEED = 5.0
const JUMP_VELOCITY = 4.5

@export
var Camera : Camera3D

# Get the gravity from the project settings to be synced with RigidBody nodes.
var gravity = ProjectSettings.get_setting(\"physics/3d/default_gravity\")

func _ready():
	Input.set_mouse_mode(Input.MOUSE_MODE_CAPTURED)

func _physics_process(delta):
	# Add the gravity.
	if not is_on_floor():
		velocity.y -= gravity * delta

	# Handle jump.
	if Input.is_action_just_pressed(\"ui_accept\") and is_on_floor():
		velocity.y = JUMP_VELOCITY

	SPEED = 5 if not Input.is_key_pressed(KEY_SHIFT) else 10
	SPEED = 2.5 if Input.is_key_pressed(KEY_CTRL) else SPEED
	# Get the input direction and handle the movement/deceleration.
	# As good practice, you should replace UI actions with custom gameplay actions.
	var input_dir = Vector2(0, 0)
	if Input.is_key_pressed(KEY_A):
		input_dir += Vector2(-1, 0)
	if Input.is_key_pressed(KEY_D):
		input_dir += Vector2(1, 0)
	if Input.is_key_pressed(KEY_W):
		input_dir += Vector2(0, -1)
	if Input.is_key_pressed(KEY_S):
		input_dir += Vector2(0, 1)
	var direction = (transform.basis * Vector3(input_dir.x, 0, input_dir.y)).normalized()
	if direction:
		velocity.x = direction.x * SPEED
		velocity.z = direction.z * SPEED
	else:
		velocity.x = move_toward(velocity.x, 0, SPEED)
		velocity.z = move_toward(velocity.z, 0, SPEED)

	move_and_slide()

func _input(event):
	if event is InputEventMouseMotion:
		var movement : Vector2 = event.relative
		Camera.rotate_x(-movement.y / 500)
		rotate_y(-movement.x / 500)

func _process(_delta):
	if Input.is_mouse_button_pressed(MOUSE_BUTTON_LEFT):
		Input.set_mouse_mode(Input.MOUSE_MODE_CAPTURED)
	if Input.is_key_pressed(KEY_ESCAPE):
		Input.set_mouse_mode(Input.MOUSE_MODE_VISIBLE)
	scale = Vector3(1, 1, 1) if not Input.is_key_pressed(KEY_CTRL) else Vector3(1, .5, 1)




"

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_k74rn"]

[sub_resource type="CapsuleMesh" id="CapsuleMesh_tq5ts"]

[sub_resource type="BoxMesh" id="BoxMesh_xqwcf"]
size = Vector3(0.2, 0.2, 0.2)

[node name="ExampleScene" type="Node"]

[node name="Lighting" type="Node" parent="."]

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="Lighting"]
transform = Transform3D(0.776509, 1.77636e-15, -0.630107, 0.477519, 0.652442, 0.588468, 0.411108, -0.757838, 0.506627, -6.35404, 6.33784, 1.41866)
light_energy = 0.0
shadow_enabled = true

[node name="WorldEnvironment" type="WorldEnvironment" parent="Lighting"]
environment = SubResource("Environment_wpvn0")

[node name="OmniLight3D" type="OmniLight3D" parent="Lighting"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.98696, 7.1275, 0.00494146)
light_energy = 2.939
shadow_enabled = true
shadow_blur = 10.0
omni_range = 44.429

[node name="OmniLight3D2" type="OmniLight3D" parent="Lighting"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 15.8513, 7.1275, 0.00494146)
light_energy = 2.939
shadow_enabled = true
shadow_blur = 10.0
omni_range = 44.429

[node name="OmniLight3D3" type="OmniLight3D" parent="Lighting"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 15.8513, 7.1275, 15.6077)
light_energy = 2.939
shadow_enabled = true
shadow_blur = 10.0
omni_range = 44.429

[node name="OmniLight3D4" type="OmniLight3D" parent="Lighting"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 3.57558, 7.1275, 15.6077)
light_energy = 2.939
shadow_enabled = true
shadow_blur = 10.0
omni_range = 44.429

[node name="Map & Col" type="Node3D" parent="."]

[node name="Floor" type="MeshInstance3D" parent="Map & Col"]
transform = Transform3D(12.8743, 0, 0, 0, 1, 0, 0, 0, 7.3671, 0, 0, 0)
mesh = SubResource("BoxMesh_x0era")
surface_material_override/0 = SubResource("StandardMaterial3D_gyww7")

[node name="Floor2" type="MeshInstance3D" parent="Map & Col"]
transform = Transform3D(6.437, 0, 0, 0, 1, 0, 0, 0, 7.367, 9.655, 0, 0)
mesh = SubResource("BoxMesh_x0era")
surface_material_override/0 = SubResource("StandardMaterial3D_cp2ox")

[node name="Floor4" type="MeshInstance3D" parent="Map & Col"]
transform = Transform3D(12.8742, 0, 0, 0, 1, 0, 0, 0, 7.3671, 0, 0, 14.7342)
mesh = SubResource("BoxMesh_x0era")
surface_material_override/0 = SubResource("StandardMaterial3D_71n5t")

[node name="Floor5" type="MeshInstance3D" parent="Map & Col"]
transform = Transform3D(6.437, 0, 0, 0, 1, 0, 0, 0, 7.367, 9.655, 0, 7.367)
mesh = SubResource("BoxMesh_x0era")
surface_material_override/0 = SubResource("StandardMaterial3D_puy43")

[node name="Floor6" type="MeshInstance3D" parent="Map & Col"]
transform = Transform3D(6.437, 0, 0, 0, 1, 0, 0, 0, 7.367, 9.655, 0, 14.734)
mesh = SubResource("BoxMesh_x0era")
surface_material_override/0 = SubResource("StandardMaterial3D_ir7d1")

[node name="Floor7" type="MeshInstance3D" parent="Map & Col"]
transform = Transform3D(5.1497, 0, 0, 0, 1, 0, 0, 0, 7.3671, -3.86227, 0, 7.3671)
mesh = SubResource("BoxMesh_x0era")
surface_material_override/0 = SubResource("StandardMaterial3D_d7xvt")

[node name="Floor8" type="MeshInstance3D" parent="Map & Col"]
transform = Transform3D(2.57485, 0, 0, 0, 1, 0, 0, 0, 7.3671, 0, 0, 7.3671)
mesh = SubResource("BoxMesh_x0era")
surface_material_override/0 = SubResource("StandardMaterial3D_4ir7p")

[node name="Floor9" type="MeshInstance3D" parent="Map & Col"]
transform = Transform3D(5.1497, 0, 0, 0, 1, 0, 0, 0, 7.3671, 3.86227, 0, 7.3671)
mesh = SubResource("BoxMesh_x0era")
surface_material_override/0 = SubResource("StandardMaterial3D_83cii")

[node name="Example Player" type="CharacterBody3D" parent="." node_paths=PackedStringArray("Camera")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -2.31749, 1.71881, 1.14893)
script = SubResource("GDScript_vmt5a")
Camera = NodePath("Camera3D")

[node name="Collider" type="CollisionShape3D" parent="Example Player"]
shape = SubResource("CapsuleShape3D_k74rn")

[node name="Capsule" type="MeshInstance3D" parent="Example Player/Collider"]
mesh = SubResource("CapsuleMesh_tq5ts")
skeleton = NodePath("../../..")

[node name="Camera3D" type="Camera3D" parent="Example Player"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.471767, 0)

[node name="AutoFootSteps" type="Node3D" parent="Example Player" node_paths=PackedStringArray("debug_poses")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.724361, 0)
script = ExtResource("1_o0483")
foot_profile = ExtResource("10_uo7lj")
audio_bus = null
volume_db = -14.151
footstep_distance = null
crouch_speed = null
walk_speed = null
run_speed = null
expected_jump_speed = null
debug_poses = [NodePath("../../debug1"), NodePath("../../debug2"), NodePath("../../debug3"), NodePath("../../debug4"), NodePath("../../debug5"), NodePath("../../debug6")]

[node name="debug1" type="MeshInstance3D" parent="."]
mesh = SubResource("BoxMesh_xqwcf")

[node name="debug2" type="MeshInstance3D" parent="."]
mesh = SubResource("BoxMesh_xqwcf")

[node name="debug3" type="MeshInstance3D" parent="."]
mesh = SubResource("BoxMesh_xqwcf")

[node name="debug4" type="MeshInstance3D" parent="."]
mesh = SubResource("BoxMesh_xqwcf")

[node name="debug5" type="MeshInstance3D" parent="."]
mesh = SubResource("BoxMesh_xqwcf")

[node name="debug6" type="MeshInstance3D" parent="."]
mesh = SubResource("BoxMesh_xqwcf")
